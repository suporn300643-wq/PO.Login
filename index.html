<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบสมัครสมาชิก</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Kanit', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .input-focus:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="flex justify-center items-center mb-4">
                <img src="https://img5.pic.in.th/file/secure-sv1/Red-White-Bold-Gladiator-Logo101.md.png" 
                     alt="Logo" 
                     class="w-20 h-20 mr-4 rounded-full shadow-lg"
                     onerror="this.src=''; this.alt='โลโก้ไม่สามารถโหลดได้'; this.style.display='none';">
                <div>
                    <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">ยินดีต้อนรับฝ่ายขายทุกท่าน</h1>
                    <h2 class="text-xl md:text-2xl font-medium text-white opacity-90">เข้าสู่ระบบ ก่อนเข้าใช้งาน</h2>
                </div>
            </div>
        </div>

        <!-- Registration Form -->
        <div class="max-w-md mx-auto glass-effect rounded-2xl shadow-2xl p-8">
            <form id="registrationForm" class="space-y-6">


                <!-- ชื่อ - นามสกุล -->
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                        ชื่อ - นามสกุล <span class="text-red-500">*</span>
                    </label>
                    <input type="text" 
                           id="name" 
                           name="name"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus"
                           placeholder="กรอกชื่อของคุณ"
                           required>
                </div>

                <!-- สังกัดฝ่าย -->
                <div>
                    <label for="department" class="block text-sm font-medium text-gray-700 mb-2">
                        สังกัดฝ่าย <span class="text-red-500">*</span>
                    </label>
                    <select id="department" 
                            name="department"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus"
                            required>
                        <option value="">เลือกสังกัดฝ่าย</option>
                        <option value="ฝ่าย4 ฝ่ายประดิษฐ์">ฝ่าย4 ฝ่ายประดิษฐ์</option>
                        <option value="ฝ่าย6 ฝ่ายสง่า">ฝ่าย6 ฝ่ายสง่า</option>
                        <option value="ฝ่าย23 ฝ่ายวิรันต์โรจน์">ฝ่าย23 ฝ่ายวิรันต์โรจน์</option>
                        <option value="ฝ่าย24 ฝ่ายสุพิชฌา">ฝ่าย24 ฝ่ายสุพิชฌา</option>
                        <option value="ฝ่าย42 ฝ่ายตรีชญาฏาฉ์">ฝ่าย42 ฝ่ายตรีชญาฏาฉ์</option>
                        <option value="ฝ่าย71 ฝ่ายไพฐูรณ์">ฝ่าย71 ฝ่ายไพฐูรณ์</option>
                        <option value="ฝ่าย81 ฝ่ายณานวุฒิ (รก.)">ฝ่าย81 ฝ่ายณานวุฒิ (รก.)</option>
                        <option value="ฝ่าย82 ฝ่ายบังอร">ฝ่าย82 ฝ่ายบังอร</option>
                        <option value="ฝ่าย103 ฝ่ายณานวุฒิ (รก.)">ฝ่าย103 ฝ่ายณานวุฒิ (รก.)</option>
                        <option value="ฝ่าย111 ฝ่ายพิมพ์ลดา">ฝ่าย111 ฝ่ายพิมพ์ลดา</option>
                        <option value="ฝ่าย118 ฝ่ายธนกร">ฝ่าย118 ฝ่ายธนกร</option>
                        <option value="ฝ่าย121 ฝ่ายกัญญาวีย์">ฝ่าย121 ฝ่ายกัญญาวีย์</option>
                        <option value="ฝ่าย127 ฝ่ายสุดารัตน์">ฝ่าย127 ฝ่ายสุดารัตน์</option>
                        <option value="ฝ่าย130 ฝ่ายอัครพัฒน์">ฝ่าย130 ฝ่ายอัครพัฒน์</option>
                    </select>
                </div>

                <!-- สาขา -->
                <div>
                    <label for="branch" class="block text-sm font-medium text-gray-700 mb-2">
                        สาขา <span class="text-red-500">*</span>
                    </label>
                    <input type="text" 
                           id="branch" 
                           name="branch"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus"
                           placeholder="กรอกสาขาของคุณ"
                           required>
                </div>

                <!-- Submit Button -->
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 btn-hover transform">
                    เข้าสู่ระบบ
                </button>
            </form>
        </div>
    </div>

    <script>


        // จัดการการส่งฟอร์ม
        document.getElementById('registrationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // ตรวจสอบข้อมูล
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            
            // ตรวจสอบว่ากรอกข้อมูลครบหรือไม่
            if (!data.name || !data.department || !data.branch) {
                Swal.fire({
                    icon: 'warning',
                    title: 'กรุณากรอกข้อมูลให้ครบถ้วน',
                    text: 'โปรดตรวจสอบข้อมูลทุกช่องให้ครบถ้วน',
                    confirmButtonText: 'ตกลง'
                });
                return;
            }

            // แสดงสถานะกำลังบันทึก
            Swal.fire({
                title: 'กำลังบันทึกข้อมูล...',
                text: 'โปรดรอสักครู่',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            try {
                // เตรียมข้อมูลสำหรับส่ง
                const submitData = {
                    name: data.name,
                    department: data.department,
                    branch: data.branch,
                    timestamp: new Date().toLocaleString('th-TH')
                };

                // ส่งข้อมูลไปยัง Google Apps Script
                const response = await fetch('https://script.google.com/macros/s/AKfycbwZs7AM3W7_FHjY7yhxvFYotTT_jpUHKm7HfaNyzuX2ZbuWQUHMT7M9L2CNtt4pL0gzGg/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(submitData)
                });

                // แสดงข้อความสำเร็จ
                await Swal.fire({
                    icon: 'success',
                    title: 'บันทึกข้อมูลสำเร็จ!',
                    text: `ยินดีต้อนรับ ${data.name}`,
                    confirmButtonText: 'ตกลง',
                    timer: 3000
                });

                // รีเซ็ตฟอร์ม
                this.reset();

            } catch (error) {
                console.error('Error:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'เกิดข้อผิดพลาด',
                    text: 'ไม่สามารถบันทึกข้อมูลได้ กรุณาลองใหม่อีกครั้ง',
                    confirmButtonText: 'ตกลง'
                });
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97cd9f9085a698e2',t:'MTc1NzQ5MzY1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


